const fs = require("fs"); const replaceFile = (file, replacements) => { let content = fs.readFileSync(file, "utf8"); let modified = false; replacements.forEach(r => { if(content.includes(r.from)) { content = content.replace(r.from, r.to); modified = true; } else if (r.regex && content.match(r.regex)) { content = content.replace(r.regex, r.to); modified = true; } }); if(modified) { fs.writeFileSync(file, content); console.log("Fixed " + file); } }; replaceFile("src/service/productService.ts", [ {regex: /queryOptions\.skip = \(page && limit\) \? \(page - 1\) \* limit : take: limit \|\| skip: \(page && limit\) \? \(page - 1\) \* limit : undefined,,;/g, to: "queryOptions.skip = (page && limit) ? (page - 1) * limit : undefined;"} ]); replaceFile("src/service/returnService.ts", [ {regex: /const skip = \(page && limit\) \? \(page - 1\) \* limit : totalPages: limit \? Math\.ceil\(total \/ limit\) : 1;\r?\n  const take = limit \|\| undefined;/g, to: "const skip = (page && limit) ? (page - 1) * limit : undefined;\n  const take = limit || undefined;"} ]); replaceFile("src/service/searchService.ts", [ {regex: /const skip = \(page && limit\) \? \(page - 1\) \* limit : page\?: number;;\r?\n  const take = limit \|\| limit\?: number;;/g, to: "const skip = (page && limit) ? (page - 1) * limit : undefined;\n  const take = limit || undefined;"}, {regex: /page,\r?\n      limit,\r?\n      total: totalProducts,\r?\n      totalPages: Math\.ceil\(totalProducts \/ limit\),/g, to: "page: page || 1,\n      limit: limit || totalProducts,\n      total: totalProducts,\n      totalPages: limit ? Math.ceil(totalProducts / limit) : 1,"} ]);
