const fs = require("fs"); const replaceFile = (file, replacements) => { let content = fs.readFileSync(file, "utf8"); let modified = false; replacements.forEach(r => { if(content.includes(r.from)) { content = content.replace(r.from, r.to); modified = true; } else if (r.regex && content.match(r.regex)) { content = content.replace(r.regex, r.to); modified = true; } }); if(modified) { fs.writeFileSync(file, content); console.log("Fixed " + file); } }; replaceFile("src/controller/colorController.ts", [ {from: "parseInt(page as string),\n      parseInt(limit as string)", to: "page,\n      limit"} ]); replaceFile("src/controller/searchController.ts", [ {from: "parseInt(page as string)", to: "(page as any)"}, {from: "parseInt(limit as string)", to: "(limit as any)"} ]); replaceFile("src/controller/sizeChartController.ts", [ {from: "parseInt(page as string),\n      parseInt(limit as string)", to: "page,\n      limit"} ]); replaceFile("src/controller/userCouponController.ts", [ {from: "skip: (page - 1) * limit,", to: "skip: (page && limit) ? (page - 1) * limit : undefined,"}, {from: "take: limit,", to: "take: limit || undefined,"} ]); replaceFile("src/service/productService.ts", [ {regex: /take: limit,/g, to: "take: limit || undefined,"}, {regex: /skip: \(page - 1\) \* limit,/g, to: "skip: (page && limit) ? (page - 1) * limit : undefined,"} ]); replaceFile("src/service/returnService.ts", [ {regex: /totalPages: limit \? Math.ceil\(total \/ limit\) : 1/g, to: "totalPages: limit ? Math.ceil(total / limit) : 1"} ]); replaceFile("src/service/searchService.ts", [ {regex: /page: number;/g, to: "page?: number;"}, {regex: /limit: number;/g, to: "limit?: number;"} ]);
