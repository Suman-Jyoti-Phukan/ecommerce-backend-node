const fs = require("fs"); const path = require("path"); const dirControllers = "./src/controller"; const dirServices = "./src/service"; function replaceInDir(dir, replacements) { const files = fs.readdirSync(dir); files.forEach(file => { if (file.endsWith(".ts")) { const filePath = path.join(dir, file); let content = fs.readFileSync(filePath, "utf8"); let modified = false; replacements.forEach(rep => { if (content.match(rep.from)) { content = content.replace(rep.from, rep.to); modified = true; } }); if (modified) { fs.writeFileSync(filePath, content); console.log("Updated: " + filePath); } } }); } const controllerReplacements = [ { from: /const limit = parseInt\(req\.query\.limit as string\) \|\| 10;/g, to: "const limit = req.query.limit ? parseInt(req.query.limit as string) : undefined;" }, { from: /const page = parseInt\(req\.query\.page as string\) \|\| 1;/g, to: "const page = req.query.page ? parseInt(req.query.page as string) : undefined;" }, { from: /const limit = req\.query\.limit \? parseInt\(req\.query\.limit as string\) : 10;/g, to: "const limit = req.query.limit ? parseInt(req.query.limit as string) : undefined;" }, { from: /const { page = 1, limit = 10 } = req\.query;/g, to: "const page = req.query.page ? Number(req.query.page) : undefined;\n    const limit = req.query.limit ? Number(req.query.limit) : undefined;" }, { from: /const { q, page = 1, limit = 10 } = req\.query;/g, to: "const q = req.query.q;\n    const page = req.query.page ? Number(req.query.page) : undefined;\n    const limit = req.query.limit ? Number(req.query.limit) : undefined;" } ]; replaceInDir(dirControllers, controllerReplacements);
