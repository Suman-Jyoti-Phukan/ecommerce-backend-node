const fs = require("fs"); const path = require("path"); const dirServices = "./src/service"; const files = fs.readdirSync(dirServices); files.forEach(file => { if (file.endsWith(".ts")) { const filePath = path.join(dirServices, file); let content = fs.readFileSync(filePath, "utf8"); let modified = false; if (content.match(/page = 1,\s*limit = 10/)) { content = content.replace(/page = 1,\s*limit = 10/g, "page?: number, limit?: number"); modified = true; } if (content.match(/limit = 10([,)])/)) { content = content.replace(/limit = 10([,)])/g, "limit?: number$1"); modified = true; } if (content.match(/const skip = \(page - 1\) \* limit;/)) { content = content.replace(/const skip = \(page - 1\) \* limit;/g, "const skip = (page && limit) ? (page - 1) * limit : undefined;\n  const take = limit || undefined;"); modified = true; content = content.replace(/take: limit/g, "take"); } if (modified) { fs.writeFileSync(filePath, content); console.log("Updated: " + filePath); } } });
